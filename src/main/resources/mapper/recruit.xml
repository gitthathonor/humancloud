<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="site.metacoding.humancloud.domain.recruit.RecruitDao">

	<select id="orderByCreatedAt" resultType="site.metacoding.humancloud.domain.recruit.Recruit">
		select *
		from recruit
		order by recruit_created_at desc
	</select>

	<select id="orderByCareer" resultType="site.metacoding.humancloud.domain.recruit.Recruit">
		select * from recruit order by
								 (
									 CASE WHEN ASCII(SUBSTRING(recruit_career,1)) BETWEEN 48 AND 57 THEN 3
										  WHEN ASCII(SUBSTRING(recruit_career,1))
		<![CDATA[<]]>
		123 THEN 2 ELSE 1 END
									 ), binary(recruit_career)
	</select>
	<insert id="save" useGeneratedKeys="true" keyProperty="recruitId">
		INSERT INTO recruit(recruit_title, recruit_career, recruit_salary, recruit_location, recruit_content, recruit_read_count, recruit_company_id, recruit_deadline,recruit_created_at) 
		VALUES(#{recruitTitle}, #{recruitCareer}, #{recruitSalary},#{recruitLocation}, #{recruitContent}, 0, #{recruitCompanyId}, NOW(),NOW())
	</insert>

	<select id="findById" resultType="site.metacoding.humancloud.domain.recruit.Recruit">
	select * from recruit 
	WHERE recruit_id = #{recruitId}
	</select>
	<select id="findByCompanyId" resultType="site.metacoding.humancloud.domain.recruit.Recruit">
		SELECT *
		FROM recruit WHERE recruit_company_id = #{recruitCompanyId}
	</select>
	<select id="findAll" resultType="site.metacoding.humancloud.domain.recruit.Recruit">
		select * from recruit

	</select>
	<update id="update">
		UPDATE recruit SET 
		recruit_title = #{recruitTitle},
		recruit_career = #{recruitCareer},
		recruit_salary = #{recruitSalary},
		recruit_location = #{recruitLocation},
		recruit_content = #{recruitContent},
		recruit_deadline = #{recruitDeadline}
		WHERE recruit_id = #{recruitId};
	</update>
	<delete id="deleteById">
		DELETE from recruit where recruit_id=#{recruitId}
	</delete>
</mapper>